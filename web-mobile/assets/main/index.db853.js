System.register("chunks:///_virtual/ApiConfig.ts",["cc"],(function(i){var s;return{setters:[function(i){s=i.cclegacy}],execute:function(){s._RF.push({},"b0e6buczTZE74ixS1/Ni9LS","ApiConfig",void 0);i("apiConfig",{useLocalApi:!0,mock:{autoStartDelayMs:300,resultDelayMs:400,isMuted:!1,resultSuccess:!0,horses:[{id:1,name:"Ngựa số 1",sku:"HORSE01",coin:50},{id:2,name:"Ngựa số 2",sku:"HORSE02",coin:75},{id:3,name:"Ngựa số 3",sku:"HORSE03",coin:100},{id:4,name:"Thần Mã",sku:"SPECIAL",coin:5e3},{id:5,name:"Ngựa số 5",sku:"HORSE01",coin:200}]}});s._RF.pop()}}}));

System.register("chunks:///_virtual/AudioController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var t,i,e,n,p,l,r,s,u;return{setters:[function(o){t=o.applyDecoratedDescriptor,i=o.inheritsLoose,e=o.initializerDefineProperty,n=o.assertThisInitialized},function(o){p=o.cclegacy,l=o._decorator,r=o.AudioSource,s=o.AudioClip,u=o.Component}],execute:function(){var h,a,c,y,f,L,b,g,R,S,C,m,P,_,d,w,q,k,z,H,M,O,v,A,T,B,G;p._RF.push({},"bbb68p9NOVHPoKMah0OH//5","AudioController",void 0);var D=l.ccclass,F=l.property;o("AudioController",(h=D("AudioController"),a=F(r),c=F(r),y=F(r),f=F(r),L=F(r),b=F(r),g=F(s),R=F(s),S=F(s),C=F(s),m=F(s),P=F(s),h((w=t((d=function(o){function t(){for(var t,i=arguments.length,p=new Array(i),l=0;l<i;l++)p[l]=arguments[l];return t=o.call.apply(o,[this].concat(p))||this,e(t,"horseRunLoop",w,n(t)),e(t,"ropeSpinLoop",q,n(t)),e(t,"horsePullLoop",k,n(t)),e(t,"oneShotSource",z,n(t)),e(t,"tickingLoop",H,n(t)),e(t,"bgm",M,n(t)),e(t,"buttonClip",O,n(t)),e(t,"winClip",v,n(t)),e(t,"loseClip",A,n(t)),e(t,"horseCelebrateClip",T,n(t)),e(t,"ropeThrow",B,n(t)),e(t,"horseHitClip",G,n(t)),t._isMuted=!0,t._loopRequests={horseRun:!1,ropeSpin:!1,horsePull:!1,ticking:!1},t}i(t,o);var p=t.prototype;return p.setMuted=function(o){this._isMuted!==o&&(this._isMuted=o,o?(this.stopAllLoops(),this.stopBGM()):(this.refreshLoopRequests(),this.playBGM()))},p.playBGM=function(){this.bgm&&!this._isMuted&&(this.bgm.loop=!0,this.bgm.playing||this.bgm.play())},p.stopBGM=function(){this.bgm&&this.bgm.playing&&this.bgm.stop()},p.playHorseRunLoop=function(){this._loopRequests.horseRun=!0,this.tryPlayLoop(this.horseRunLoop,!0)},p.stopHorseRunLoop=function(){this._loopRequests.horseRun=!1,this.stopLoop(this.horseRunLoop)},p.playRopeSpinLoop=function(){this._loopRequests.ropeSpin=!0,this.tryPlayLoop(this.ropeSpinLoop,!0)},p.stopRopeSpinLoop=function(){this._loopRequests.ropeSpin=!1,this.stopLoop(this.ropeSpinLoop)},p.playHorsePullLoop=function(){this._loopRequests.horsePull=!0,this.tryPlayLoop(this.horsePullLoop,!0)},p.stopHorsePullLoop=function(){this._loopRequests.horsePull=!1,this.stopLoop(this.horsePullLoop)},p.playButtonClick=function(){this.playOneShot(this.buttonClip)},p.playWin=function(){this.playOneShot(this.winClip)},p.playLose=function(){this.playOneShot(this.loseClip)},p.playHorseCelebrate=function(){this.playOneShot(this.horseCelebrateClip)},p.playRopeThrow=function(){var o=this;this.stopRopeSpinLoop(),this.playOneShot(this.ropeThrow),this.scheduleOnce((function(){o.stopHorseRunLoop()}),2)},p.playHorseHit=function(){this.playOneShot(this.horseHitClip)},p.playTicking=function(){this._loopRequests.ticking=!0,this.tryPlayLoop(this.tickingLoop,!0)},p.stopTicking=function(){this._loopRequests.ticking=!1,this.stopLoop(this.tickingLoop)},p.refreshLoopRequests=function(){this.tryPlayLoop(this.horseRunLoop,this._loopRequests.horseRun),this.tryPlayLoop(this.ropeSpinLoop,this._loopRequests.ropeSpin),this.tryPlayLoop(this.horsePullLoop,this._loopRequests.horsePull),this.tryPlayLoop(this.tickingLoop,this._loopRequests.ticking)},p.stopAllLoops=function(){this.stopLoop(this.horseRunLoop),this.stopLoop(this.ropeSpinLoop),this.stopLoop(this.horsePullLoop),this.stopLoop(this.tickingLoop)},p.tryPlayLoop=function(o,t){t&&o&&!this._isMuted&&(o.loop=!0,o.playing||o.play())},p.stopLoop=function(o){o&&o.playing&&o.stop()},p.playOneShot=function(o){var t,i;if(o&&!this._isMuted){var e=null!=(t=null!=(i=this.oneShotSource)?i:this.horseRunLoop)?t:this.node.getComponent(r);null==e||e.playOneShot(o)}},t}(u)).prototype,"horseRunLoop",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(d.prototype,"ropeSpinLoop",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(d.prototype,"horsePullLoop",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(d.prototype,"oneShotSource",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(d.prototype,"tickingLoop",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(d.prototype,"bgm",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(d.prototype,"buttonClip",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(d.prototype,"winClip",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(d.prototype,"loseClip",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(d.prototype,"horseCelebrateClip",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(d.prototype,"ropeThrow",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(d.prototype,"horseHitClip",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=d))||_));p._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundScroller.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,r,i,s,a,c,l,d,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,s=e._decorator,a=e.Node,c=e.Sprite,l=e.Vec3,d=e.tween,u=e.Component}],execute:function(){var p,h,f,g,v,_;i._RF.push({},"ba3fdQDYd1C8oEGbavJkPn3","BackgroundScroller",void 0);var b=s.ccclass,S=s.property;e("BackgroundScroller",(p=b("BackgroundScroller"),h=S(a),p((v=t((g=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,o(t,"scrollSpeed",v,r(t)),o(t,"otherBackground",_,r(t)),t.backgroundWidth=0,t._speed=0,t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.backgroundWidth=this.node.getComponentInChildren(c).spriteFrame.width,this._speed=this.scrollSpeed},i.update=function(e){this.node.translate(new l(this._speed*e,0,0)),this.node.position.x>this.backgroundWidth&&this.node.setPosition(0,this.node.position.y,this.node.position.z)},i.catachState=function(e,t){var n=this;void 0===e&&(e=.5);var o={v:this._speed};d(o).to(e,{v:0},{easing:"quadOut",onUpdate:function(){n._speed=o.v}}).call((function(){n._speed=0,null==t||t()})).start()},i.reset=function(){this._speed=this.scrollSpeed},i.holdState=function(e){var t=this._speed*(1-e);this._speed=t},t}(u)).prototype,"scrollSpeed",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-100}}),_=t(g.prototype,"otherBackground",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=g))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/ButtonStartAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,i,e,s,r;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,e=t.Vec3,s=t.tween,r=t.Component}],execute:function(){var a;n._RF.push({},"8f70cUYKSpLOapKWmXmBCS5","ButtonStartAnimation",void 0);var c=i.ccclass;i.property,t("ButtonStartAnimation",c("ButtonStartAnimation")(a=function(t){function n(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this)._offsetShowHide=400,o.posShow=void 0,o.posHide=void 0,o}o(n,t);var i=n.prototype;return i.start=function(){var t=this.node.position,o=new e(t.x,t.y,t.z),n=new e(t.x,t.y+this._offsetShowHide,t.z);this.posShow=n,this.posHide=o},i.setButton=function(t,o){var n=t?this.posShow:this.posHide,i=s(this.node).to(.5,{position:n});o&&i.call(o),i.start()},n}(r))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameApi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ApiConfig.ts"],(function(t){var e,n,s;return{setters:[function(t){e=t.extends},function(t){n=t.cclegacy},function(t){s=t.apiConfig}],execute:function(){n._RF.push({},"45391e8A4FFNKzMA7cka5XP","GameApi",void 0);var i=function(){function t(t){this.listeners=new Map,this.readyForStart=!1,this.config=t}var n=t.prototype;return n.send=function(t,n){if("ready"!==t)return"setMuted"===t&&this.readyForStart?(this.readyForStart=!1,void this.dispatch("startGame",{horses:this.config.horses.map((function(t){return e({},t)})),is_muted:this.config.isMuted})):void("endGame"===t&&this.dispatch("setResult",{success:this.config.resultSuccess}));this.readyForStart=!0},n.on=function(t,e){this.listeners.set(t,e)},n.dispose=function(){this.listeners.clear()},n.dispatch=function(t,e){var n=this.listeners.get(t);if(n){var s="startGame"===t?this.config.autoStartDelayMs:this.config.resultDelayMs;setTimeout((function(){return n(e)}),s)}},t}(),o=function(){function t(){this.listeners=new Map,this.boundListener=this.onMessage.bind(this),this.targetWindow=null,this.sourceId="acb-catch-horse","undefined"!=typeof window&&(this.targetWindow=window.parent!==window?window.parent:window,window.addEventListener("message",this.boundListener))}var e=t.prototype;return e.send=function(t,e){if(this.targetWindow){var n=JSON.stringify({source:this.sourceId,event:t,payload:e});this.targetWindow.postMessage(n,"*")}},e.on=function(t,e){this.listeners.set(t,e)},e.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("message",this.boundListener),this.listeners.clear()},e.onMessage=function(t){var e=t.data;if(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){return}if("object"==typeof e&&null!==e){var n=e,s=n.source,i=n.event,o=n.payload;if(s!==this.sourceId&&i){var r=i,a=this.listeners.get(r);a&&a(o)}}}},t}();t("GameApi",function(){function t(t){void 0===t&&(t=s),this.transport=void 0,this.config=t,this.transport=t.useLocalApi?new i(t.mock):new o}var e=t.prototype;return e.onStartGame=function(t){this.transport.on("startGame",t)},e.onSetResult=function(t){this.transport.on("setResult",t)},e.sendReady=function(){this.transport.send("ready",{})},e.sendSetMuted=function(t){this.transport.send("setMuted",{is_muted:t})},e.sendCountDown=function(){this.transport.send("countDown",{})},e.sendEndGame=function(t){this.transport.send("endGame",{coin:t})},e.dispose=function(){this.transport.dispose()},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Horse.ts","./RopeController.ts","./UIController.ts","./GameApi.ts","./MapController.ts","./AudioController.ts"],(function(t){var e,i,r,n,o,s,a,l,u,h,c,p,d,f,_,w,m,g,b,T,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized,o=t.createForOfIteratorHelperLoose,s=t.extends},function(t){a=t.cclegacy,l=t._decorator,u=t.Prefab,h=t.Node,c=t.Pool,p=t.instantiate,d=t.Vec3,f=t.math,_=t.Component},function(t){w=t.Horse},function(t){m=t.RopeController},function(t){g=t.UIController},function(t){b=t.GameApi},function(t){T=t.MapController},function(t){v=t.AudioController}],execute:function(){var S,H,y,C,R,P,L,M,z,x,N,I,O,D,G,A,E,k,F,U,W,B,Y,q,V,X,j,K,Z,J,Q,$,tt,et,it,rt,nt,ot,st,at,lt,ut,ht,ct,pt;a._RF.push({},"aa6d5C8+sBMRakTKHWy2SL0","GameManager",void 0);var dt=l.ccclass,ft=l.property,_t={SPECIAL:"ACB",HORSE01:"color_2",HORSE02:"color_3",HORSE03:"color_4"},wt="color_2";t("GameManager",(S=dt("GameManager"),H=ft(u),y=ft([h]),C=ft(m),R=ft(g),P=ft(h),L=ft(h),M=ft(h),z=ft(h),x=ft(T),N=ft(h),I=ft(h),O=ft(v),D=ft(h),G=ft({tooltip:"Automatically throw the rope when the timer expires instead of ending the round."}),S((k=e((E=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,r(e,"horsePrefab",k,n(e)),r(e,"lanes",F,n(e)),r(e,"rope",U,n(e)),r(e,"ui",W,n(e)),r(e,"laneParent",B,n(e)),r(e,"endPosLand",Y,n(e)),r(e,"horseParent",q,n(e)),r(e,"horseCatch",V,n(e)),r(e,"bgScroller",X,n(e)),r(e,"Left",j,n(e)),r(e,"Right",K,n(e)),r(e,"audioController",Z,n(e)),r(e,"timeNode",J,n(e)),r(e,"spawnInterval",Q,n(e)),r(e,"throwDuration",$,n(e)),r(e,"autoThrowOnTimeout",tt,n(e)),r(e,"maxThrows",et,n(e)),r(e,"speedMin",it,n(e)),r(e,"speedMax",rt,n(e)),r(e,"rewardMin",nt,n(e)),r(e,"rewardMax",ot,n(e)),r(e,"laneWidth",st,n(e)),r(e,"baseGap",at,n(e)),r(e,"minActivePerLane",lt,n(e)),r(e,"numHorseSpawn",ut,n(e)),r(e,"resultResolveDelay",ht,n(e)),r(e,"throwNumTouchHold",ct,n(e)),r(e,"timeThrowNumTouchHold",pt,n(e)),e._pool=null,e._horses=[],e._spawnTimer=0,e._throwTimer=0,e._pauseThrowTimer=!1,e._throwsLeft=0,e._isThrowTimeOut=!1,e._coins=0,e._state="idle",e._capturedHorse=null,e._pendingCatchHorse=null,e._pendingCatchTimer=0,e._api=null,e._serverHorsePool=[],e._pendingReward=0,e._isMuted=!1,e._hasTimeoutEndGame=!1,e}i(e,t);var a=e.prototype;return a.onLoad=function(){var t=this;this._pool=new c((function(){if(!t.horsePrefab)throw new Error("horsePrefab is not assigned");return p(t.horsePrefab)}),4,(function(t){return t.destroy()})),this.lanes=this.laneParent.children},a.start=function(){var t,e,i,r=this;null!=(t=null==(e=this.lanes[0])?void 0:e.worldPositionY)||this.Right.worldPositionY;this.lanes.forEach((function(t){t.setWorldPosition(new d(r.Left.worldPosition.x,t.worldPositionY,t.worldPositionZ))})),this.endPosLand.worldPosition=this.Left.worldPosition,null==(i=this.rope)||i.bindGame(this),this.enterWaitingState(!0),this.initApi()},a.onDestroy=function(){var t;null==(t=this._api)||t.dispose()},a.update=function(t){var e;if("running"===this._state){var i;if(!this._capturedHorse&&this._throwsLeft>0&&this._throwTimer>0&&(this._pauseThrowTimer||(this._throwTimer-=t),this._throwTimer<=0&&(this._throwTimer=0,this.handleThrowTimeout())),this._pendingCatchHorse)if(this._pendingCatchTimer-=t,null!=(i=this.rope)&&i.IsEnoughTouchForCatch()){var r=this._pendingCatchHorse,n=r.getReward();this.handleCatchSuccess(r,n),this.clearPendingCatch()}else if(this._pendingCatchTimer<=0){var o=this._pendingCatchHorse;this.handleCatchSuccess(o,0),this.clearPendingCatch()}null==(e=this.ui)||e.updateHUD(Math.max(0,this._throwTimer),this._coins,this._throwsLeft)}},a.prepareRound=function(){var t,e,i,r,n;this.clearHorses(),this._coins=0,this._throwsLeft=this.maxThrows,this._isThrowTimeOut=!1,this._spawnTimer=.1,this.resetThrowTimer(),this._state="countdown",this._hasTimeoutEndGame=!1,this.resetCaptureState(),this.fillInitialHorses(),null==(t=this.ui)||t.updateHUD(this._throwTimer,this._coins,this._throwsLeft),null==(e=this.ui)||e.setStatus("Nhấn liên tục để chơi game !"),null==(i=this.ui)||i.setStatusServer("Touch to start"),null==(r=this.rope)||r.resetState(),null==(n=this.rope)||n.showButtonCatch()},a.startRound=function(){var t,e,i,r,n;"countdown"===this._state&&(this._state="running",this._hasTimeoutEndGame=!1,this.resetThrowTimer(),null==(t=this.ui)||t.updateHUD(this._throwTimer,this._coins,this._throwsLeft),null==(e=this.ui)||e.setStatus("Nhấn liên tục để bắt ngựa!"),null==(i=this.ui)||i.setStatusServer("Bắt đầu đếm giờ"),null==(r=this._api)||r.sendCountDown(),null==(n=this.audioController)||n.playTicking())},a.endRound=function(){var t,e,i;"ended"!==this._state&&(this._state="ended",this._throwTimer=0,this._capturedHorse&&(this._capturedHorse.markMissed(),this.resetCaptureState()),null==(t=this.rope)||t.enableInput(!1),null==(e=this.ui)||e.setStatus("Hết lượt! Đang xin lượt mới..."),null==(i=this.ui)||i.updateHUD(this._throwTimer,this._coins,this._throwsLeft),this.prepareNextRound())},a.restart=function(){this.prepareNextRound()},a.tryCatch=function(t,e){var i;if("running"===this._state&&!(this._capturedHorse||this._throwsLeft<=0)){this._throwsLeft-=1;for(var r,n=null,s=Number.POSITIVE_INFINITY,a=o(this._horses);!(r=a()).done;){var l=r.value,u=l.node.worldPosition,h=Math.abs(u.x-t.x);h<s&&(s=h,n=l)}if(n){this._capturedHorse=n,this._pendingCatchHorse=n,this._pendingCatchTimer=this.timeThrowNumTouchHold,n.node.setWorldPosition(t),this.bgScroller.holdState(.3),this._horses.forEach((function(t){t!=n&&t.upSpeedHoldState()})),n.node.active=!1;var c=n.getConfig();this.rope.setHorseCatch(c)}null==(i=this.ui)||i.updateHUD(this._throwTimer,this._coins,this._throwsLeft)}},a.isWaitingForTouchToStart=function(){return"countdown"===this._state},a.handleTouchToStart=function(){return!!this.isWaitingForTouchToStart()&&(this.timeNode.active=!0,this.startRound(),!0)},a.handleCatchSuccess=function(t,e){this._capturedHorse=t,this.startAwaitingResult(e)},a.handleThrowTimeout=function(){var t,e,i;if(!(this._throwsLeft<=0||"running"!==this._state))if(this._isThrowTimeOut=!0,null==(t=this.audioController)||t.stopTicking(),this.autoThrowOnTimeout)this.tryAutoThrowOnTimeout();else{this._throwsLeft=0;null==(e=this.ui)||e.setStatusServer("Hết thời gian! Đang kết thúc lượt..."),this._throwTimer=0,null==(i=this.ui)||i.updateHUD(this._throwTimer,this._coins,this._throwsLeft),this.finishRoundByTimeout()}},a.tryAutoThrowOnTimeout=function(){var t;null==(t=this.rope)||t.throwRope()},a.fillInitialHorses=function(){if(this.lanes.length){for(var t=0;t<this.numHorseSpawn;t++){var e=this.getNextStartOffset();this.spawnHorse(0,e,t)}this._spawnTimer=this.spawnInterval}},a.getMiddleLanePosition=function(){return 0===this.lanes.length?null:this.lanes[0].worldPosition.clone()},a.isPullingActive=function(){return!!this._capturedHorse},a.spawnHorse=function(t,e,i){var r,n;if(void 0===e&&(e=0),void 0===i&&(i=0),this._pool&&this.horsePrefab&&0!==this.lanes.length){var o=this.lanes[i%this.lanes.length].position,s=this.Left.position.x,a=o.x,l=this.speedMin,u=this.pickHorseTemplate(i),h=null!=(r=null==u?void 0:u.coin)?r:Math.round(f.randomRange(this.rewardMin,this.rewardMax)),c=this.getSkinNameForSku(null==u?void 0:u.sku),p=this._pool.alloc(),_=o.y;p.parent||(p.parent=this.horseParent),p.active=!0,p.setPosition(new d(a,o.y,o.z)),p.setSiblingIndex(i);var m=null!=(n=p.getComponent(w))?n:p.addComponent(w),g={offsetY:_,startX:a,endX:s,speed:l,reward:h,skinName:c,offset:e};m.init(this,g),this._horses.push(m)}},a.getNextStartOffset=function(){var t=this.lanes[0];if(!t)return 0;for(var e,i=t.position.x,r=!1,n=i,s=o(this._horses);!(e=s()).done;){var a=e.value;if(a&&a.isActiveRunner()){var l=a.getPositionX();(!r||l>n)&&(n=l,r=!0)}}return r?i-(n+this.baseGap):0},a.onRopeThrow=function(){"running"==this._state&&(this._pauseThrowTimer=!0,this.timeNode.active=!1)},a.resetCaptureState=function(){this._capturedHorse&&(this._capturedHorse.node.parent=this.horseParent),this._capturedHorse=null},a.clearPendingCatch=function(){this._pendingCatchHorse=null,this._pendingCatchTimer=0},a.resetThrowTimer=function(){this._throwTimer=this.throwDuration},a.markClosestAsMiss=function(t,e){for(var i,r,n=null,s=Number.POSITIVE_INFINITY,a=o(this._horses);!(r=a()).done;){var l=r.value,u=d.distance(l.node.worldPosition,t);u<s&&u<=e&&(s=u,n=l)}null==(i=n)||i.markMissed()},a.clearHorses=function(){for(var t,e=o(this._horses);!(t=e()).done;){var i=t.value;i&&(this._pool?this._pool.free(i.node):i.node.destroy())}this._horses.length=0},a.initApi=function(){var t=this;this._api=new b,this._api.onStartGame((function(e){return t.handleStartGame(e)})),this._api.onSetResult((function(e){return t.handleSetResult(e)})),this.requestServerStart()},a.handleStartGame=function(t){var e,i=this;this._serverHorsePool=(null!=(e=t.horses)?e:[]).map((function(t){return s({},t)})),this.applyMuteState(t.is_muted),this._pendingReward=0,this.numHorseSpawn=t.horses.length%2==0?t.horses.length:t.horses.length+1,this.scheduleOnce((function(){i.prepareRound(),i.ui.setStatusServer("Touch to start")}),1)},a.handleSetResult=function(t){var e=this;if("awaiting_result"===this._state){var i=t.success;this.scheduleOnce((function(){return e.applyResult(i)}),this.resultResolveDelay)}},a.applyResult=function(t){var e,i,r=this;if("awaiting_result"===this._state){var n,o,s;if(this._state="ended",this.bgScroller.catachState(),t)null==(n=this.rope)||n.playResultSuccess();else if(0==this._isThrowTimeOut)null==(o=this.rope)||o.playResultFail();if(t)this._coins+=this._pendingReward,this.scheduleOnce((function(){var t,e;r.ui.showRewardTextFx(null==(t=r._capturedHorse)?void 0:t.getReward()),null==(e=r.audioController)||e.playWin()}),1),null==(s=this.audioController)||s.playHorseCelebrate();else this.scheduleOnce((function(){var t;null==(t=r.audioController)||t.playLose()}),1);var a=t?"Bắt ngựa thành công!":"Bắt ngựa thất bại!";null==(e=this.ui)||e.setStatusServer(a),null==(i=this.ui)||i.updateHUD(this._throwTimer,this._coins,this._throwsLeft),this._pendingReward=0,this.scheduleOnce((function(){return r.prepareNextRound()}),3)}},a.requestServerStart=function(){var t;this._api&&(this._api.sendReady(),this._api.sendSetMuted(this._isMuted),null==(t=this.ui)||t.setStatusServer("Đang chờ server bắt đầu..."))},a.enterWaitingState=function(t){var e,i,r;this._state="idle",null==(e=this.rope)||e.enableInput(!1),this.resetCaptureState(),this.clearHorses(),this.bgScroller.reset(),this._spawnTimer=0,this._throwTimer=0,this._pauseThrowTimer=!1,this._pendingReward=0,this._hasTimeoutEndGame=!1,null==(i=this.audioController)||i.stopHorseRunLoop(),t&&(this._coins=0,this._throwsLeft=this.maxThrows),this.timeNode.active=!1,null==(r=this.ui)||r.updateHUD(this._throwTimer,this._coins,this._throwsLeft)},a.prepareNextRound=function(){this.enterWaitingState(!0),this.requestServerStart(),this.rope.resetState()},a.pickHorseTemplate=function(t){if(void 0===t&&(t=-1),!this._serverHorsePool.length)return null;var e=-1==t?Math.floor(Math.random()*this._serverHorsePool.length):t;return this._serverHorsePool[e%this._serverHorsePool.length]},a.getSkinNameForSku=function(t){var e;return t&&null!=(e=_t[t])?e:wt},a.startAwaitingResult=function(t){var e,i,r,n;this._pendingReward=t,this._state="awaiting_result",null==(e=this.rope)||e.enableInput(!1),null==(i=this.ui)||i.setStatusServer("Đã chọn ngựa, chờ kết quả..."),null==(r=this.ui)||r.updateHUD(this._throwTimer,this._coins,this._throwsLeft),null==(n=this._api)||n.sendEndGame(t)},a.finishRoundByTimeout=function(){var t,e,i=this;"running"!==this._state||this._hasTimeoutEndGame||(this._hasTimeoutEndGame=!0,this._state="awaiting_result",this.resetCaptureState(),this.clearPendingCatch(),null==(t=this.rope)||t.enableInput(!1),this._pendingReward=0,null==(e=this._api)||e.sendEndGame(0),this.scheduleOnce((function(){"awaiting_result"===i._state&&i.applyResult(!1)}),this.resultResolveDelay))},a.applyMuteState=function(t){var e;this._isMuted=t,null==(e=this.audioController)||e.setMuted(t)},e}(_)).prototype,"horsePrefab",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(E.prototype,"lanes",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=e(E.prototype,"rope",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(E.prototype,"ui",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(E.prototype,"laneParent",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=e(E.prototype,"endPosLand",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=e(E.prototype,"horseParent",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=e(E.prototype,"horseCatch",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=e(E.prototype,"bgScroller",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=e(E.prototype,"Left",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=e(E.prototype,"Right",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=e(E.prototype,"audioController",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(E.prototype,"timeNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=e(E.prototype,"spawnInterval",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.1}}),$=e(E.prototype,"throwDuration",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),tt=e(E.prototype,"autoThrowOnTimeout",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),et=e(E.prototype,"maxThrows",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),it=e(E.prototype,"speedMin",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 220}}),rt=e(E.prototype,"speedMax",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),nt=e(E.prototype,"rewardMin",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ot=e(E.prototype,"rewardMax",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),st=e(E.prototype,"laneWidth",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 520}}),at=e(E.prototype,"baseGap",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 500}}),lt=e(E.prototype,"minActivePerLane",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),ut=e(E.prototype,"numHorseSpawn",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),ht=e(E.prototype,"resultResolveDelay",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),ct=e(E.prototype,"throwNumTouchHold",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),pt=e(E.prototype,"timeThrowNumTouchHold",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),A=E))||A));a._RF.pop()}}}));

System.register("chunks:///_virtual/Horse.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,s,n,o,a,r,h,l,d,u,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,s=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,r=t.Node,h=t.sp,l=t.Label,d=t.Vec3,u=t.tween,f=t.Component}],execute:function(){var _,c,p,y,b,A,m,g,v,N,H;o._RF.push({},"a7848LCWHhOlbySR9tnXUNG","Horse",void 0);var S=a.ccclass,R=a.property,w=0,I=1,M=2,C=3,L=4,F=5,U=6;t("Horse",(_=S("Horse"),c=R(r),p=R(h.Skeleton),y=R(l),b=R(r),_((g=i((m=function(t){function i(){for(var i,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return i=t.call.apply(t,[this].concat(o))||this,s(i,"body",g,n(i)),s(i,"bodyAnim",v,n(i)),s(i,"labelReward",N,n(i)),s(i,"infoNode",H,n(i)),i._state=w,i._cfg=null,i._game=null,i._direction=1,i.CATCH_ANIM="horse_catch",i.FAIL_ANIM="horse_fail",i.HOLD_ANIM="horse_hold",i.RUN_ANIM="horse_run",i._offset=0,i._laneLen=0,i._speed=1,i._isUpSpdHoldState=!1,i}e(i,t);var o=i.prototype;return o.init=function(t,i){var e;this._game=t,this._cfg=i,this._state=I,this._speed=this._cfg.speed,this._isUpSpdHoldState=!1,this._direction=-1,this.infoNode&&(this.infoNode.active=!0),this.labelReward&&(this.labelReward.string=""+i.reward),this._offset=null!=(e=i.offset)?e:0;var s=this.node.position,n=i.startX-this._offset;this.node.setPosition(n,this._cfg.offsetY,s.z),this.applySkin(i.skinName),this.playRun()},o.tryCatch=function(t,i){if(!this._cfg||this._state!==I)return 0;var e=this.node.worldPosition;return d.distance(e,t)>i?0:this.beginHoldForResult()},o.tryCatchByX=function(t,i){return this._cfg&&this._state===I?(this.node.setWorldPosition(t),this.beginHoldForResult()):0},o.markMissed=function(){this._state!==I&&this._state!==M&&this._state!==L||(this._state=C,this.playMissed())},o.update=function(t){this._cfg&&this._state!==M&&this._state!==L&&this._state!==F&&this._state!==U&&(this._state,this.move(t))},o.move=function(t){if(this._cfg){if(this._offset+=this._speed*t,this._offset>this._laneLen){var i,e,s=null!=(i=null==(e=this._game)?void 0:e.getNextStartOffset())?i:0;this._offset=s,this._state=I,this._isUpSpdHoldState&&(this._isUpSpdHoldState=!1,this._speed=0)}var n=this._cfg.startX-this._offset,o=this.node.position;this.node.setPosition(n,o.y,o.z)}},o.playRun=function(){if(this.bodyAnim)this.bodyAnim.setAnimation(0,this.RUN_ANIM,!0);else if(this.body){this.body.angle=0,u(this.body).stop();var t=this.body.position.clone();u(this.body).repeatForever(u().to(.25,{position:new d(t.x,t.y+6,t.z)}).to(.25,{position:t})).start()}},o.playCaught=function(){this.bodyAnim&&this.bodyAnim.setAnimation(0,this.CATCH_ANIM,!1)},o.playMissed=function(){if(this.bodyAnim)return this.infoNode&&(this.infoNode.active=!1),this.bodyAnim.setAnimation(0,this.FAIL_ANIM,!1),void this.bodyAnim.addAnimation(0,this.RUN_ANIM,!0,0)},o.beginHoldForResult=function(){return this._cfg?(this._state=L,this.playHold(),this.node.setSiblingIndex(this._game.numHorseSpawn),this._cfg.reward):0},o.resolveResult=function(t){this._state===L&&(this._state=t?F:U,t?this.playCaught():this.playResultFail())},o.getReward=function(){var t,i;return null!=(t=null==(i=this._cfg)?void 0:i.reward)?t:0},o.applySkin=function(t){t&&this.bodyAnim&&this.bodyAnim.setSkin(t)},o.playHold=function(){this.bodyAnim&&this.bodyAnim.setAnimation(0,this.HOLD_ANIM,!0)},o.playResultFail=function(){var t=this;if(this.bodyAnim){this.bodyAnim.setAnimation(0,this.FAIL_ANIM,!1);this.bodyAnim.addAnimation(0,this.RUN_ANIM,!0,0);var i=this.bodyAnim;return this.scheduleOnce((function(){t._offset+=180,t.upSpeedHoldState()}),1.8),void i.setCompleteListener((function(e){i.setCompleteListener(null),t._state=I}))}},o.upSpeedHoldState=function(t){void 0===t&&(t=2),this._speed+=this._speed*t,this._isUpSpdHoldState=!0},o.getPositionX=function(){return this.node.position.x},o.isActiveRunner=function(){return this._state===I||this._state===C},o.getConfig=function(){return this._cfg},i}(f)).prototype,"body",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=i(m.prototype,"bodyAnim",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(m.prototype,"labelReward",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=i(m.prototype,"infoNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=m))||A));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioController.ts","./BackgroundScroller.ts","./ButtonStartAnimation.ts","./GameManager.ts","./Horse.ts","./MapController.ts","./ParallaxLayer.ts","./RopeController.ts","./UIController.ts","./ApiConfig.ts","./GameApi.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ParallaxLayer.ts"],(function(t){var e,r,n,a,o,i,l,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){o=t.cclegacy,i=t._decorator,l=t.Component},function(t){u=t.ParallaxLayer}],execute:function(){var c,s,p,h,f,y,d,g,b;o._RF.push({},"3dcf0g9JD9OYZHFcuGsQfH3","MapController",void 0);var m=i.ccclass,v=i.property;t("MapController",(c=m("MapController"),s=v(u),p=v(u),h=v(u),c((d=e((y=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o))||this,n(e,"skyLayer",d,a(e)),n(e,"mountain",g,a(e)),n(e,"ground",b,a(e)),e}r(e,t);var o=e.prototype;return o.catachState=function(t){this.ground.catachState(),this.mountain.catachState()},o.reset=function(){this.ground.reset(),this.mountain.reset()},o.holdState=function(t){this.ground.holdState(t),this.mountain.holdState(t)},e}(l)).prototype,"skyLayer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=e(y.prototype,"mountain",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=e(y.prototype,"ground",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=y))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/ParallaxLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,s,n,o,r,a,l,h,c,p,d,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,l=e.Node,h=e.UITransform,c=e.view,p=e.Vec3,d=e.tween,u=e.Component}],execute:function(){var f,g,v,_,m,w;r._RF.push({},"e8522yHRJ9PGKjoHOPPBy6e","ParallaxLayer",void 0);var y=a.ccclass,x=a.property;e("ParallaxLayer",(f=y("ParallaxLayer"),g=x([l]),f((m=t((_=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,s(t,"speed",m,n(t)),s(t,"segments",w,n(t)),t._width=0,t._halfView=0,t._speedScrollerCached=0,t}i(t,e);var r=t.prototype;return r.onLoad=function(){if(0===this.segments.length&&(this.segments=this.node.children),0!==this.segments.length){var e=this.segments[0].getComponent(h);this._width=e.width;var t=c.getVisibleSize();this._halfView=.5*t.width;for(var i=Math.floor(this.segments.length/2),s=0;s<this.segments.length;s++){var n=s-i;this.segments[s].setPosition(new p(n*this._width,0,0))}}},r.update=function(e){if(!(this._width<=0||0===this.segments.length)){for(var t,i=o(this.segments);!(t=i()).done;){var s=t.value,n=s.position;s.setPosition(n.x+this._speedScrollerCached*e,n.y,n.z)}this.wrapLeftToRight()}},r.wrapLeftToRight=function(){for(var e,t=this.segments[0],i=this.segments[0],s=o(this.segments);!(e=s()).done;){var n=e.value;n.position.x<t.position.x&&(t=n),n.position.x>i.position.x&&(i=n)}i.position.x-.5*this._width>this._halfView&&i.setPosition(t.position.x-this._width,i.position.y,i.position.z)},r.catachState=function(e,t){var i=this;void 0===e&&(e=.5);var s={v:this._speedScrollerCached};d(s).to(e,{v:0},{easing:"quadOut",onUpdate:function(){i._speedScrollerCached=s.v}}).call((function(){i._speedScrollerCached=0,null==t||t()})).start()},r.reset=function(){this._speedScrollerCached=this.speed},r.holdState=function(e){var t=this._speedScrollerCached*(1-e);this._speedScrollerCached=t},t}(u)).prototype,"speed",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),w=t(_.prototype,"segments",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=_))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/RopeController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ButtonStartAnimation.ts","./AudioController.ts"],(function(t){var o,i,n,e,l,a,u,s,r,h,c,d,p,f,T,H;return{setters:[function(t){o=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,e=t.assertThisInitialized},function(t){l=t.cclegacy,a=t._decorator,u=t.sp,s=t.Node,r=t.Label,h=t.input,c=t.Input,d=t.UITransform,p=t.Vec3,f=t.Component},function(t){T=t.ButtonStartAnimation},function(t){H=t.AudioController}],execute:function(){var _,y,b,m,v,C,g,w,A,S,R,P,D,B,L,N,I,z,O,k,E,F,U,M;l._RF.push({},"3cb32VB8WtGy7xBDfMgZdI9","RopeController",void 0);var W=a.ccclass,x=a.property;t("RopeController",(_=W("RopeController"),y=x(u.Skeleton),b=x(s),m=x(u.Skeleton),v=x(s),C=x(T),g=x(r),w=x(s),A=x(s),S=x(H),_((D=o((P=function(t){function o(){for(var o,i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];return o=t.call.apply(t,[this].concat(l))||this,n(o,"lasso",D,e(o)),n(o,"touchArea",B,e(o)),n(o,"buttonTouch",L,e(o)),n(o,"catchTarget",N,e(o)),n(o,"buttonCatch",I,e(o)),n(o,"rewardHorseLabel",z,e(o)),n(o,"horseNodeReward",O,e(o)),n(o,"touchToStartPanel",k,e(o)),n(o,"audio",E,e(o)),n(o,"catchRadius",F,e(o)),n(o,"throwCooldown",U,e(o)),n(o,"pullMoveSpd",M,e(o)),o._game=null,o._enabled=!0,o._numTouchHold=0,o._lastnumTouchHold=0,o._timeHoldCountDown=0,o._isCatching=!1,o._startPosition=void 0,o._offsetHorsePull=100,o._offsetRopePull=200,o.HAND_CATCH="horse_catch",o.HAND_FAIL="horse_fail",o.HAND_HOLD="horse_hold",o.HAND_HOLD_START="hand_hold_start",o.HAND_RUN="hand_idle",o.BTN_IDLE="button_idle",o.BTN_HOLD="button_hold",o}i(o,t);var l=o.prototype;return l.start=function(){this._startPosition=this.node.position.clone(),this.playHandIdle(),this.playButtonIdle(),this.resetState()},l.onEnable=function(){this.touchArea?this.touchArea.on(s.EventType.TOUCH_START,this.onTouch,this):h.on(c.EventType.TOUCH_START,this.onTouch,this),this.touchToStartPanel&&this.touchToStartPanel.on(s.EventType.TOUCH_START,this.onTouchStart,this)},l.onDisable=function(){this.touchArea?this.touchArea.off(s.EventType.TOUCH_START,this.onTouch,this):h.off(c.EventType.TOUCH_START,this.onTouch,this),this.touchToStartPanel&&this.touchToStartPanel.off(s.EventType.TOUCH_START,this.onTouchStart,this)},l.update=function(t){var o,i;if(null!=(o=null==(i=this._game)?void 0:i.isPullingActive())&&o&&this._enabled&&0==this.IsEnoughTouchForCatch()){this._timeHoldCountDown-=t,this._timeHoldCountDown<0&&(this._timeHoldCountDown=0);var n=this._numTouchHold-this._lastnumTouchHold;this._lastnumTouchHold=this._numTouchHold;var e=this.node.position,l=n*this.pullMoveSpd*t,a=this.pullMoveSpd/50*t,u=e.y-l+a;u>this._startPosition.y+this._offsetHorsePull&&(u=this._startPosition.y+this._offsetHorsePull),u<-this._offsetRopePull&&(u=-this._offsetRopePull),this.node.setPosition(e.x,u,e.z)}},l.bindGame=function(t){this._game=t},l.enableInput=function(t){this._enabled=t},l.showButtonCatch=function(){var t=this;this.buttonCatch&&this.buttonCatch.setButton(!0,(function(){var o,i;t.lasso.node.active=!0,t.enableInput(!0),null==(o=t.audio)||o.playRopeSpinLoop(),null==(i=t.audio)||i.playHorseRunLoop()}))},l.hideButtonCatch=function(){var t;this.buttonCatch&&(this.enableInput(!1),this.lasso.node.active=!1,this.buttonCatch.setButton(!1)),null==(t=this.audio)||t.stopRopeSpinLoop()},l.onTouchStart=function(t){var o;this._enabled&&null!=(o=this._game)&&o.handleTouchToStart()&&(this.touchToStartPanel.active=!1)},l.onTouch=function(t){var o,i,n,e;if((this.playButtonHold(),null==(o=this.audio)||o.playButtonClick(),this._enabled)&&(null==(i=this._game)||!i.isWaitingForTouchToStart()))if(null!=(n=null==(e=this._game)?void 0:e.isPullingActive())&&n){if(!(this._timeHoldCountDown>=0))return;this._numTouchHold++}else this.throwRope()},l.uiToWorld=function(t){var o,i=(null!=(o=this.touchArea)?o:this.node).getComponent(d);if(!i)return t;var n=new p;return i.convertToWorldSpaceAR(t,n),n},l.playTouchFeedback=function(t){if(t)return this.playHandHold(),void this.playButtonHold();this.playHandHold(),this.playButtonHold()},l.playHandIdle=function(){var t;null==(t=this.lasso)||t.setAnimation(0,this.HAND_RUN,!0)},l.playHandHoldHorse=function(){var t;null==(t=this.lasso)||t.setAnimation(0,this.HAND_HOLD,!0)},l.playHandCatch=function(){this.lasso&&this.lasso.setAnimation(0,this.HAND_CATCH,!1)},l.playHandFail=function(){this.lasso&&this.lasso.setAnimation(0,this.HAND_FAIL,!1)},l.playHandHold=function(t){if(this.lasso){var o=this.lasso;o.setCompleteListener((function(i){o.setCompleteListener(null),null==t||t()})),o.setAnimation(0,this.HAND_HOLD_START,!1)}},l.playButtonIdle=function(){var t;null==(t=this.buttonTouch)||t.setAnimation(0,this.BTN_IDLE,!0)},l.playButtonHold=function(){var t,o=this;console.log("playButtonHold");var i=null==(t=this.buttonTouch)?void 0:t.setAnimation(0,this.BTN_HOLD,!1);this.scheduleOnce((function(){o.playButtonIdle()}),.1),i&&(i.trackTime=1.1,i.trackEnd=1.2)},l.playResultFail=function(){var t;this.playHandFail(),this.playButtonIdle(),null==(t=this.audio)||t.stopHorsePullLoop()},l.playResultSuccess=function(){var t;this.playHandCatch(),this.playButtonIdle(),null==(t=this.audio)||t.stopHorsePullLoop()},l.resetState=function(){var t;this.playHandIdle(),this.playButtonIdle(),this._numTouchHold=0,this._lastnumTouchHold=0,this._timeHoldCountDown=this._game.timeThrowNumTouchHold,this._isCatching=!1,this.node.setPosition(this._startPosition),this.hideButtonCatch(),this.applySkin("default"),this.horseNodeReward.active=!1,null==(t=this.audio)||t.stopHorsePullLoop(),this.touchToStartPanel.active=!0},l.IsEnoughTouchForCatch=function(){return this._numTouchHold>this._game.throwNumTouchHold},l.setHorseCatch=function(t){var o,i;this.applySkin(t.skinName),this.playHandHoldHorse(),this.setReward(t.reward),null==(o=this.audio)||o.playHorsePullLoop(),null==(i=this.audio)||i.playHorseHit()},l.throwRope=function(){var t,o=this;if(!this._isCatching){var i,n,e=null;if(this.catchTarget)e=this.catchTarget.worldPosition.clone();else e=null!=(i=null==(n=this._game)?void 0:n.getMiddleLanePosition())?i:null;e&&(this._isCatching=!0,this.playHandHold(),this._game.onRopeThrow(),this.scheduleOnce((function(){var t;o._game.tryCatch(e,o.catchRadius),o._timeHoldCountDown=o._game.timeThrowNumTouchHold,null==(t=o.audio)||t.playRopeThrow()}),1),null==(t=this.audio)||t.stopTicking())}},l.applySkin=function(t){t&&this.lasso&&this.lasso.setSkin(t)},l.setReward=function(t){t&&(this.horseNodeReward.active=!0,this.rewardHorseLabel.string=t.toString())},o}(f)).prototype,"lasso",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=o(P.prototype,"touchArea",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(P.prototype,"buttonTouch",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=o(P.prototype,"catchTarget",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=o(P.prototype,"buttonCatch",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(P.prototype,"rewardHorseLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(P.prototype,"horseNodeReward",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(P.prototype,"touchToStartPanel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(P.prototype,"audio",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(P.prototype,"catchRadius",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 90}}),U=o(P.prototype,"throwCooldown",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),M=o(P.prototype,"pullMoveSpd",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),R=P))||R));l._RF.pop()}}}));

System.register("chunks:///_virtual/UIController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,i,n,a,o,l,s,u,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,l=t.Label,s=t.UIOpacity,u=t.tween,c=t.Component}],execute:function(){var b,p,L,f,h,w,g,y,d,v,m,x,z,F,S;a._RF.push({},"a7918uv0rdOMLr2jweIGRps","UIController",void 0);var C=o.ccclass,I=o.property;t("UIController",(b=C("UIController"),p=I(l),L=I(l),f=I(l),h=I(l),w=I(l),g=I(l),b((v=e((d=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,i(e,"timeLabel",v,n(e)),i(e,"coinLabel",m,n(e)),i(e,"throwLabel",x,n(e)),i(e,"statusLabel",z,n(e)),i(e,"statusServerLabel",F,n(e)),i(e,"rewardLabelFx",S,n(e)),e}r(e,t);var a=e.prototype;return a.updateHUD=function(t,e,r){this.timeLabel&&(this.timeLabel.string=Math.ceil(t)+"s"),this.coinLabel&&(this.coinLabel.string=""+e),this.throwLabel&&(this.throwLabel.string=""+r)},a.setStatus=function(t){this.statusLabel&&(this.statusLabel.string=t)},a.setStatusServer=function(t){this.statusServerLabel&&(this.statusServerLabel.string=t)},a.showRewardTextFx=function(t){if(this.rewardLabelFx){this.rewardLabelFx.string="+"+t;var e=this.rewardLabelFx.node.parent,r=e.position.clone(),i=r.clone();i.y+=200;var n=e.getComponent(s);n||(n=e.addComponent(s)),n.opacity=255,e.active=!0,e.setPosition(r),u(e).to(1.5,{position:i},{easing:"quadOut"}).start(),u(n).to(1.5,{opacity:0},{easing:"quadOut"}).call((function(){e.setPosition(r),n.opacity=255,e.active=!1})).start()}},e}(c)).prototype,"timeLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(d.prototype,"coinLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(d.prototype,"throwLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(d.prototype,"statusLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(d.prototype,"statusServerLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(d.prototype,"rewardLabelFx",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=d))||y));a._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});